<style>
        /* FULL CALENDAR JQUERY CSS*/
    #booking {
        display: none;
    }
    .mainCalendar{
        background-color: #f6f3e4;
    }

    .fc-event-head .fc-event-focusName, .fc-event-head .fc-event-time {
        float: left;
    }

    .fc-event-rate, .fc-event-content-confirm, .fc-event-content-approve, .fc-event-content-reject {
        float: right;
    }

    .fc-widget-header, .fc-widget-content {
        border: 1px solid #9EB668;
    }

    .fc-border-separate thead {
        text-transform: uppercase;
    }

    .fc-border-separate thead tr th {
        padding: 5px;
        background-color: #f0f9e6;
        font: 12px 'dosissemibold';
        color: #2e3a12;
        -webkit-box-shadow:  0 0 0 1px rgba(255, 255, 255, 1) inset;
        box-shadow: 0 0 0 1px rgba(255, 255, 255, 1) inset;
        -moz-box-shadow: 0 0 0 1px rgba(255, 255, 255, 1) inset;
    }

    .fc-border-separate tbody td {
        background-color: #FCFFF6;
    }

    .fc-border-separate tbody td.fc-other-month {
        background-color: white;
    }
    .fc-header-title h2{
        font:18px 'dosissemibold' !important;
        color: #344608 !important;
    }
    table:not(.fc-agenda-days) .fc-today {
        background-color: #E5F9C8 !important;
    }

    .fc-border-separate .fc-today .fc-day-number {
        color: #719511;
    }

    ul li {
        text-decoration: none;
    }

    #dialog-form .mainBooking {
        padding: 18px 42px 0 18px;
    }
    .mainBooking .formRow div{
        float:left;
    }

    .mainBooking .formRow .t-165{
        width:165px;
    }
    .mainBooking .txt{
        padding: 2px 9px 0 20px;
    }
    .mainBooking #recipiend_id{
        width:177px;
    }
    .mainBooking #duration{
        width: 68px;
    }
     .mainBooking #rate{
         width: 40px;
     }
    .mainBooking  .button{
         font-family: 'dosissemibold' !important;
         font-size: 12px !important;
        float:right;
     }

    .mainBooking  .formRow .label{
        width:95px;
        padding-top: 2px;
    }
    .mainBooking .checkBoxRow div{
        padding-top: 5px;
    }
    .mainBooking .checkBoxRow .label{
        width: 114px;
    }
    .mainBooking .formRow {
        padding-bottom: 19px;
    }


    .fc-button-prev, .fc-button-next{
        width: 15px !important;
    }
    .fc-button-today{
        margin: 0 7px !important;
    }
    .formRow textarea{
        width:269px;
    }

    .fc-event{

        height:auto !important;
        font:10px arial !important;

    }

    .fc-event-time, .fc-event-focusName, .fc-event-rate, .fc-event-content-description, .fc-event-content-requested, .fc-event-title{

        font:10px arial !important;
    }
    .fc-event-head .fc-event-time, .fc-event-focusName, .fc-event-rate{
        padding-right: 10px;
        padding-top: 5px;
        padding-bottom: 5px;
    }
    .fc-event-content-description{
        padding-top:10px;
    }
    .fc-event-head .fc-event-time, .fc-event-content-description, .fc-event-content-requested{
        padding-left:10px;

    }
    .fc-corner-left .fc-button-inner, .fc-corner-left .fc-event-inner{ margin-left:0 !important;}
    .fc-event-skin{color:#474940;}
    .fc-event-inner{

        color:#474940;
        -webkit-box-shadow:  0 0 10px -7px rgba(0, 0, 0, 0.66) inset;
        box-shadow: 0 0 10px -7px rgba(0, 0, 0, 0.66) inset;
        -moz-box-shadow:  0 0 10px -7px rgba(0, 0, 0, 0.66) inset;

        overflow: visible;
    }
    .fc-event-content-requested{
        float:left;
        padding-top: 4px;
    }
    .fc-event-head{
       /* background-color: #fedbdb !important;*/
        /*border: 1px solid #c18989 !important;*/
        width: auto !important;

    }
    .fc-event:hover{
        z-index:9 !important;
    }
    .fc-agenda .fc-agenda-axis {
        width: 34px;
        padding: 0 4px;
        vertical-align: middle;
        text-align: center;
        white-space: nowrap;
        font-weight: normal;
    }
    .fc-event-hori{
        border: none !important;
    }
    .fc-event-content{
        /*border: 1px solid #c18989 !important;*/
        width: auto !important;
        padding-bottom: 5px;
    }
    .fc-header .fc-button{
        margin: 0;
        width: 66px;
    }


</style>
<div class="mainCalendar mainContainer clearfix">
    <div id="dialog-form" title="BOOKING DETAILS">
        <div class="mainBooking">
            <form method="post" action="" id = "booking">
                <div class="formRow clearfix">
                    <div class = "label">Select User:</div>  <div><?php echo $this->bookingForm->recipiend_id;?></div></div>
                <div class="formRow clearfix">
                    <div class = "label">Select Date:</div> <div><?php echo $this->bookingForm->started_at;?></div></div>
                <div class="formRow clearfix">
                    <div class = "label">Focus Name:</div> <div><?php echo $this->bookingForm->focus_name;?></div></div>
                <div class="formRow clearfix">
                    <div class = "label">Lesson Time:</div> <div><?php echo $this->bookingForm->duration;?></div><div class ="txt">Rate:</div><div><?php echo $this->bookingForm->rate;?></div></div>
                <div class="formRow clearfix checkBoxRow">
                    <div class = "label">Video Recording:</div> <div><?php echo $this->bookingForm->video;?></div></div>
                <div class="formRow clearfix checkBoxRow">
                    <div class = "label">Feedback:</div> <div><?php echo $this->bookingForm->feedback;?></div></div>
                <div class="formRow clearfix checkBoxRow">
                    <div class = "label">Notes Copy:</div> <div><?php echo $this->bookingForm->notes;?></div></div>
                <div class="formRow clearfix">
                    <div class = "label">Info:</div> <div><?php echo $this->bookingForm->add_info;?></div></div>
                <div class ="buttonRow clearfix">
                <?php echo $this->bookingForm->sendBooking;?>
                </div>
            </form>

        </div>
    </div>

    <script type='text/javascript'>
        jQuery(document).ready(function () {
            var date = new Date();
            var d = date.getDate();
            var m = date.getMonth();
            var y = date.getFullYear();

            jQuery('#calendar').fullCalendar({
                editable:true,
                timeFormat: '(h:mm)tt -',
                buttonIcons:{
                    day: ''
                },
                disableDragging:true,
                disableResizing:true,
                allDay:false,
                allDaySlot:false,
                header:{
                    left:'title',
                    center:'month, agendaDay',
                    right:'prev,today,next'
                },
                dayClick:function (date, allDay, jsEvent, view) {
                    jQuery('#calendar').fullCalendar('changeView', 'agendaDay');
                    jQuery('#calendar').fullCalendar('gotoDate', date);

                },
                eventClick:function (event, element) {
                    var view = jQuery('#calendar').fullCalendar('getView');
                    if (view.name == 'agendaDay') { // if clicked on event while in agendaDay
                    } else {
                        jQuery('#calendar').fullCalendar('changeView', 'agendaDay');
                        jQuery('#calendar').fullCalendar('gotoDate', event.start);
                    }

                },

                events:function (start, end, callback) {
                    jQuery("body").append('<div class="loadingIcon"></div>');
                    $.ajax({
                        cache:false,
                        url:'booking/index',
                        success:function (msg) {
                            jQuery('.loadingIcon').remove();
                            var events = [];
                            for (var c = 0; c < msg.booking.length; c++) {
                                if (msg.booking[c].recipient_status == '1') {
                                    var eventColor = '#effad0';
                                    var borderColor = '#7e954c';
                                } else {
                                    eventColor = '#ffe8e8';
                                    borderColor = '#c18989';
                                }


                                events.push({
                                    title:msg.booking[c].focus_name,
                                    start:msg.booking[c].started_at,
                                    started_at:msg.booking[c].started_at,
                                    recipient_id:msg.booking[c].recipient_id,
                                    recipient_status:msg.booking[c].recipient_status,
                                    add_info:msg.booking[c].add_info,
                                    rate:msg.booking[c].rate,
                                    duration:msg.booking[c].duration,
                                    video:msg.booking[c].video,
                                    feedback:msg.booking[c].feedback,
                                    notes:msg.booking[c].notes,
                                    sender_id:msg.booking[c].sender_id + "",
                                    booking_id:msg.booking[c].id + "",
                                    user_id:msg.id,
                                    allDay:false,
                                    color:eventColor,
                                    backgroundColor:eventColor,
                                    borderColor:borderColor

                                });
                            }
                            callback(events);

                        }
                    });
                },

            eventRender:function (event, element) {
                    var view = jQuery('#calendar').fullCalendar('getView');
                    if (view.name == 'agendaDay') { // render event in agendaDay
                        if (event.duration == '0') {
                            var duration = 'lesson';
                        } else {
                            duration = event.duration + ' min';
                        }
                        element.find(".fc-event-head").append('<div class ="fc-event-focusName"> ' + event.title + '</div>');
                        element.find(".fc-event-head").append('<div class = "fc-event-rate">$' + event.rate + ' / ' + duration + '</div>');
                        element.find(".fc-event-content").append('<div class = "fc-event-content-description">' + event.add_info + '</div>');
                        element.find(".fc-event-content").append('<div class = "fc-event-content-requested">Subscriber:' + event.sender_id + '</div>');

                        if (event.recipient_status == '0' && event.user_id == event.recipient_id) {
                            element.find(".fc-event-content").append('<input type = "button"  id ="rejectBooking" onclick="rejectBooking(this)" value = "Reject"  class="fc-event-content-reject fc-button reject">');
                            element.find(".fc-event-content").append('<input type = "button" id ="confirmBooking" onclick="confirmBooking(this)" value = "Confirm" class = "fc-event-content-confirm fc-button">');
                            element.find(".fc-event-content").append('<input type = "hidden" id = "booking_id"  value = ' + event.booking_id + ' >');
                            element.find(".fc-event-content").append('<input type = "hidden" id = "sender_id"  value = ' + event.sender_id + ' >');
                        } else if (event.recipient_status == '1') {
                            element.find(".fc-event-content").append('<div class="fc-event-content-approve"><span>Approved</span></div>');
                        }else{
                            element.find(".fc-event-content").append('<div class="fc-event-content-approve pending"><span>Pending</span></div>');
                        }
                    }
                }


            });

//FORM DIALOG JQUERY
            $('.fc-header tbody').append('<tr><td><input type="button" id="bookLesson" class = "button-2 book" value="book lesson"><td></tr>');

            $("#dialog-form").dialog({
                autoOpen:false,
                height:560,
                width:450,
                modal:true,
                resizable:false,
                close:function () {

                }
            });


            $('#started_at').datetimepicker();

            $('#sendBooking').click(function () {
                $.post(

                    "/booking/add/0/controller%3D%3Ebooking/1/action%3D%3Eadd", {
                        "recipient_id":$('#recipiend_id').val(),
                        "focus_name":$('#focus_name').val(),
                        "started_at":$('#started_at').val(),
                        "duration":$('#duration').val(),
                        "feedback":$('#feedback:checked').val() || 0,
                        "video":$('#video:checked').val() || 0,
                        "notes":$('#notes:checked').val() || 0,
                        "rate":$('#rate').val(),
                        "add_info":$('#add_info').val()


                    },
                    function (response) {
                        window.location.reload();

                    });

                return false;
            });
            $('#bookLesson').click(function () {
                jQuery('#booking').css('display', 'block');
                $("#dialog-form form").get(0).reset();
                $("#dialog-form").dialog("open");

            });
        });//END JQUERY

        function confirmBooking(e) {
            $.post(

                "/booking/approve/0/controller%3D%3Ebooking/1/action%3D%3Eapprove", {
                    "booking_id":$('#booking_id').val()
                },
                function (response) {
                    $(e).parents('.fc-event-inner').find('.fc-event-head').css('background-color', '#effad0');
                    $(e).parents('.fc-event-inner').css('background-color', '#effad0');
                    $(e).parents('.fc-event').css('border-color', '#7e954c');
                    $(e).parents('.fc-event-inner').css('border-color', '#7e954c');
                    $(e).parent().append('<div class="fc-event-content-approve"><span>Approved</span></div>');
                    $(e).parents('.fc-event').find('.fc-event-content-reject').remove();
                    $(e).parents('.fc-event').find('.fc-event-content-confirm').remove();


                });
        }
        function rejectBooking(e) {
            $.post(

                "/booking/reject/0/controller%3D%3Ebooking/1/action%3D%3Ereject", {
                    "booking_id":$('#booking_id').val()
                },
                function (response) {
                    e.parentNode.parentNode.parentNode.parentNode.removeChild(e.parentNode.parentNode.parentNode);
                });
        }

    </script>

    <div id='calendar'></div>
</div>
