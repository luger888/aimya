<div class="featuresTab mainContainer clearfix">

    <div class="filters clearfix">
        <?php if (Zend_Auth::getInstance()->getIdentity()->role != 1): ?>
        <span class="selectBox s-111"><?php echo $this->filters->author; ?></span>
        <?php endif;?>
        <span class="selectBox s-123"><?php echo $this->filters->lesson_category; ?></span>

        <p>Display:</p>

    </div>
    <!--End filters-->

    <?php $profileModel = new Application_Model_Profile(); ?>
    <div class="messageContent clearfix">
        <input id="featured_count" type="hidden" value="<?php echo $this->featuredCount['featuredCount']; ?>">
        <?php //Zend_Debug::dump($this->featured); ?>
        <?php foreach ($this->featured as $person): ?>

        <div class="shadowSeparator clearfix">
            <div class="shadowSeparatorBox clearfix">
                <div class="featureItem clearfix">

                    <?php $avatarPath = $profileModel->getAvatarPath($person['id'], 'medium') ?>

                        <div class="imageBlock boxShadow"><img src="<?php echo $avatarPath;?>"></div>

                    <div class="featuredButtonsTop clearfix">

                        <?php echo '<a class ="button-2 view viewProfile" href="' . $this->baseUrl() . '/user/' . $person['id'] . '">VIEW PROFILE</a>'; ?>
                        <?php $friendTable = new Application_Model_DbTable_Friends(); ?>
                        <?php $isFriend = $friendTable->isFriend($person['id']); ?>
                        <?php $isPending = $friendTable->isPending($person['id']); ?>
                        <?php if (Zend_Auth::getInstance()->getIdentity()->id != $person['id']): ?>
                        <?php  if ($isFriend) { // if friend, dont show the add to account button
                            echo "<a class ='sendMessage createMessage button-2 floatLeft' onclick='sendMessage(" . $person['id'] . ", this)' href='javascript:void(1)'>" . $this->translate('SEND MESSAGE') . "</a>";
                        } elseif ($isPending) {
                            echo "<span class ='request_sent'>" . $this->translate('REQUEST SENT') . "</span>";
                        } else {
                            echo "<a class ='button-2 add addAccount' onclick='addToFriend(" . $person['id'] . ", this);' href='javascript:void(1)'>" . $this->translate('ADD TO MY ACCOUNT') . "</a>";
                        }
                        ?>
                        <?php endif;?>
                        <?php echo '<input type="hidden" value = "' . $person["id"] . '">';?>

                    </div>
                    <!--End featuredButtonsTop-->
                    <ul class="featuredInfo">
                        <li class="clearfix">
                            <span class="title"><?php echo $this->translate('Name:') ?></span>

                            <div
                                class="featuredTxt"><?php echo  ' ' . $person['firstname'] . ' ' . $person['lastname'];?></div>
                        </li>

                        <li class="clearfix">
                            <span class="title"><?php echo $this->translate('Time zone:') ?></span>

                            <div class="featuredTxt"><?php echo ' UTC ' . $person['timezone'];?></div>
                        </li>

                        <?php if (count($person['service_offered']) > 0): ?>
                        <li class="clearfix">
                            <span class="title"><?php echo $this->translate('Service offered:') ?></span>

                            <div class="featuredTxt">
                                <?php
                                $i = 0;
                                foreach ($person['service_offered'] as $index => $service) {
                                    echo $service['subcategory'];
                                    if (count($person['service_offered']) - 1 != $i) echo ', ';
                                    $i++;
                                }
                                ?>
                            </div>
                        </li>
                        <?php endif; ?>
                        <?php if (count($person['service_requested']) > 0): ?>
                        <li class="clearfix">
                            <span class="title"><?php echo $this->translate('Service requested:') ?></span>

                            <div class="featuredTxt">
                                <?php
                                $i = 0;
                                foreach ($person['service_requested'] as $index => $service) {
                                    echo $service['subcategory'];
                                    if (count($person['service_requested']) - 1 != $i) echo ', ';
                                    $i++;
                                }
                                ?>
                            </div>
                        </li>
                        <?php endif; ?>
                        <?php if (count($person['add_info']) > 0): ?>
                        <li class="clearfix">
                            <span class="title"><?php echo $this->translate('About me:') ?></span>

                            <div class="featuredTxt more"><?php echo $person['add_info'];?></div>
                        </li>
                        <?php endif; ?>
                    </ul>
                    <!--End featuredInfo -->

                </div>
                <div class='profileRole'><?php $role = ($person['role'] == '1' ? 'Student' : 'Instructor');
                    echo $role;?></div>
                <!--End featureItem -->
            </div>
            <!--End shadowSeparatorBox-->
        </div><!--End shadowSeparator-->


        <?php endforeach; ?>
        <?php if ($this->featuredCount['featuredCount'] > 5): ?>
        <div class="feauteresButtons clearfix">
            <input class="showMore button-2 more" onclick="showMoreUsers(); return false;" type="button"
                   value="<?php echo $this->translate('VIEW MORE') ?>">
        </div><!--End feauteresButtons-->
        <?php endif; ?>
    </div>
    <!--End messageContent -->


</div><!--End featuresTab -->
<script type="text/javascript">
    $(document).ready(function () {

        $(".more").shorten({
            "showChars":200
        });

    });
</script>
